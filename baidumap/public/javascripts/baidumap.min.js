/*! baidumap 2018-01-26 */

"use strict";(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});var Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;var opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);var domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})}),(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})}),(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})}),(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})}),(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);var chat;domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})}),(chat=io()).on("rep message",function(e){$("#message").append("<li>"+e+"</li>")}),$("form").submit(function(){return chat.emit("chat message",$("#m").val()),$("#m").val(""),!1});Derivative=function(){var e={canvas:"",blurRadius:0};function a(a){e.canvas=a.canvas,e.blurRadius=a.blurRadius,e.gusArray=n(2*a.blurRadius+1,2*a.blurRadius+1),e.guslinearArray=[],function(){for(var a=e.blurRadius,t=n(2*a+1,2*a+1),r=(2*a+1)/2,i=0,o=-a;o<a+1;o++)for(var s=-a;s<a+1;s++){var l=1/(2*Math.PI*r*r)*Math.pow(Math.E,-(s*s+o*o)/(2*r*r));i+=l,t[o+a][s+a]=l}for(var d=0;d<2*a+1;d++)for(var c=0;c<2*a+1;c++)e.gusArray[d][c]=t[d][c]/i,e.guslinearArray[d*(2*a+1)+c]=t[d][c]/i}(),$(e.canvas).attr("width",$(document).width()),$(e.canvas).attr("height",$(document).height()),$(e.canvas).css("display","none")}function t(){html2canvas(document.body).then(function(a){var t=$(e.canvas).get(0).getContext("2d");console.log("开始渲染");var r=new Date,i=function(a){var t=a.width,r=a.height,i=new n(a.data.length,0),o=e.blurRadius;{if(!(t<2*o+1||r<2*o+1)){for(var s=0;s<a.data.length;s+=4){for(var l=0,d=0,c=0,u=0,p=-o;p<o+1;p++)for(var h=-o;h<o+1;h++)Math.round(s/4/t)+p<0||Math.round(s/4/t)+p>r-1||s/4%t+h<0||s/4%t+h>t-1?(l+=a.data[s]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[s+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[s+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[s+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]):(l+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)]*e.guslinearArray[(p+o)*(2*o+1)+h+o],d+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+1]*e.guslinearArray[(p+o)*(2*o+1)+h+o],c+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+2]*e.guslinearArray[(p+o)*(2*o+1)+h+o],u+=a.data[4*((Math.round(s/4/t)+p)*t+s/4%t+h)+3]*e.guslinearArray[(p+o)*(2*o+1)+h+o]);i[s]=Math.round(l),i[s+1]=Math.round(d),i[s+2]=Math.round(c),i[s+3]=Math.round(u)}var m=new ImageData(i,a.width,a.height);return m}console.log("高斯模糊的直接大于长或者宽，不支持")}}(a.getContext("2d").getImageData(0,0,$(document).width(),$(document).height())),o=(new Date).getTime()-r.getTime();console.log("结束渲染，用时"+o),t.putImageData(i,0,0,0,0,$(document).width(),$(document).height()),$(e.canvas).css("display","block")});var a=document.createElement("div"),t=document.createElement("button"),r={width:"500px",height:"180px",backgroundColor:"#f8f8f8",border:"1px solid #ccc",position:"absolute",top:"50%",left:"50%",margin:"-90px 0 0 -250px",zIndex:"999",textAlign:"center",lineHeight:"180px"};for(var i in r)a.style[i]=r[i];document.body.appendChild(a),arguments[0]&&(a.innerHTML=arguments[0]),t.innerHTML="关闭";var o={border:"1px solid #ccc",backgroundColor:"#fff",width:"70px",height:"30px",textAlign:"center",lineHeight:"30px",outline:"none",position:"absolute",bottom:"10px",right:"20px"};for(var s in o)t.style[s]=o[s];a.appendChild(t),t.addEventListener("click",function(){a.style.display="none",$(e.canvas).css("display","none")})}function n(e,a){var t={};if(a){t=[];for(var n=0;n<a;n++){t[n]=[];for(var r=0;r<e;r++)t[n][r]=0}}else t=new Uint8ClampedArray(e);return t}return function(){this.alert=t,this.init=a}}(),Domhelper=function(){this.CreateSearchResultPanel=function(e){$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='keyitem_"+t+"' class='keyworditem' index='"+t+"'><a class='search_item'><i class='search'>"+e[t].name+"</i><em>"+e[t].address+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.createKeywordPanel=function(e){this.data=e,$("#searchrestult_panel").empty(),$("#searchrestult_panel").css("display","block");for(var a=$("<ul></ul>"),t=0;t<e.length&&t<10;t++){var n=$("<li id='suggestitem_"+t+"' class='suggestitem' index='"+t+"'><a><i class='default'>"+e[t].name+"</i><em>"+e[t].district+"</em></a></li>");a.append(n)}$("#searchrestult_panel").append(a)},this.data={}},socket=io(),derivative=new Derivative;window.alert=derivative.alert;opts={canvas:"#guassian_blur_container",blurRadius:2};derivative.init(opts);domhelper=new Domhelper,city=$("#city").val(),map=new BMap.Map("allmap");console.log((void 0).city),map.centerAndZoom((void 0).city),map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]})),map.addControl(new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT})),map.setCurrentCity((void 0).city),map.enableScrollWheelZoom(!0),$.get("/map/suggestion",{keyword:""},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}),map.addEventListener("tilesloaded",function(){$("#allmap .anchorBL").css("display","none"),$("#search_btn").on("click",function(){alert("点击！")}),$("#guassian_blur_container").css("display","none"),$("#search_input").on("input propertychange",function(){""!=$("#search_input").val().trim()?$.get("/map/suggestion",{keyword:$("#search_input").val()},function(e){var a=JSON.parse(e);0==a.status?domhelper.createKeywordPanel(a.result):console.log("获取关键字推荐信息失败."+a.message)}):domhelper.createKeywordPanel([])}),$("#searchrestult_panel").on("click","li.keyworditem",function(e){console.log(domhelper.data[parseInt($(this).attr("index"))].name),$.get("/map/search",{keyword:domhelper.data[parseInt($(this).attr("index"))].name},function(e){var a=JSON.parse(e);0==a.status?domhelper.CreateSearchResultPanel(a.results):console.log("查询关键字推荐信息失败."+a.message)})})});